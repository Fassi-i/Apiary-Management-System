@using Microsoft.AspNetCore.Mvc.Rendering
@model List<Apiary>

@{
    ViewData["Title"] = "Пасеки (админ)";
    var apiaries = Model ?? new List<Apiary>();
    var currentApiaryId = ViewData["CurrentApiaryId"]?.ToString();
}

<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewData["Title"]</title>

    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="~/css/style.css">
</head>
<body>
    <style>
        .actions-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 16px;
            margin-bottom: 16px;
        }

        .filter-form {
            display: flex;
            align-items: center;
            gap: 8px;
            flex: 1;
            max-width: 400px;
        }
    </style>

    <div class="container">
        <div class="header">
            <h1>Пасеки</h1>
            <p>Список всех пасек в системе</p>
        </div>
        <style>
            .actions-row {
                display: flex;
                justify-content: space-between;
                align-items: center;
                gap: 16px;
                margin-bottom: 16px;
            }

            .search-form {
                display: flex;
                align-items: center;
                gap: 8px;
                flex: 1;
                max-width: 500px;
            }

                .search-form .form-control {
                    flex: 1;
                }
        </style>

        <div class="actions-row">
            <form asp-action="AdminIndex" method="get" class="search-form">
                <select name="apiaryId"
                        class="form-control"
                        style="max-width: 220px;">
                    <option value="">Все пасеки</option>
                    @foreach (var apiary in (IEnumerable<SelectListItem>)ViewBag.Apiaries)
                    {
                        <option value="@apiary.Value"
                                selected="@(ViewData["CurrentApiary"]?.ToString() == apiary.Value ? "selected" : null)">
                            @apiary.Text
                        </option>
                    }
                </select>

                <button type="submit" class="action-button action-secondary">
                    Применить
                </button>
            </form>

            <a asp-controller="Apiary"
               asp-action="Create"
               class="action-button action-primary">
                Добавить пасеку
            </a>
        </div>


        <table class="data-table">
            <thead>
                <tr>
                    <th>Номер</th>
                    <th>Название</th>
                    <th>Владелец</th>
                    <th>Адрес</th>
                    <th>Выездная</th>
                    <th></th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                @foreach (var apiary in apiaries)
                {
                    <tr>
                        <td>#@apiary.Id.ToString().PadLeft(4, '0')</td>
                        <td>@apiary.Name</td>
                        <td>@apiary.Owner?.LastName @apiary.Owner?.FirstName</td>
                        <td>@apiary.Address</td>
                        <td>@(apiary.IsMobile ? "Да" : "Нет")</td>
                        <td>
                            <a asp-controller="Apiary"
                               asp-action="Edit"
                               asp-route-id="@apiary.Id"
                               class="action-button action-secondary">
                                Изменить
                            </a>
                        </td>
                        <td>
                            @if (apiary.ApiaryStatus == -1)
                            {
                                <a asp-controller="Apiary"
                                   asp-action="Delete"
                                   asp-route-id="@apiary.Id"
                                   class="action-button action-danger">
                                    Удалить
                                </a>
                            }
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
